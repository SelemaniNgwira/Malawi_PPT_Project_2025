(--- title: "ppt_study_analysis Table1_5" format: html ---

```{r}
#| echo: false

library(tidyverse)
library(lubridate)
library(readxl)
library(janitor)
library(gt)
library(rio)
library(here)
library(gtsummary)
library(pacman)
p_load(cleanepi, cowplot, cardx)

# loading data 

ppt_data <- import(here("data", "PPT_study.xlsx")) %>%
  clean_names()

# # converting character variables to factors and convert them to lower cases. 
ppt_data <- ppt_data |>
  mutate(across(where(is.character), str_to_lower)) |>
  mutate(across(where(is.character), ~ str_replace_all(.x, "_", " "))) |>
  mutate(across(where(is.character), as.factor)) %>%
  mutate(familiar_digitalhealth=recode(
      familiar_digitalhealth,
      "heard of but never used"="not familiar"),
      
      believe_report_ill=recode(
      believe_report_ill,
      "strongly agree  ndikugwirizana nazo kwam"="strongly agree", 
      "agree  ndikugwirizana nazo"="agree"),
      
      comfort_report=recode(
      comfort_report,
      "strongly agree  ndikugwirizana nazo kwam"="strongly agree", 
      "agree  ndikugwirizana nazo"="agree", 
      "neutral  osakhala mbali iliyonse"= "neutral"),
      
      use_digitalsystem=recode(
      use_digitalsystem,
      "strongly agree  ndikugwirizana nazo kwam"="strongly agree", 
      "agree  ndikugwirizana nazo"="agree" 
      
      ),
      
      
      digital_safe=recode(
      digital_safe,
     "strongly agree  ndikugwirizana nazo kwam"="strongly agree", 
      "agree  ndikugwirizana nazo"="agree", 
      "neutral  osakhala mbali iliyonse"= "neutral"),
      
      join_program=recode(
      join_program,
      "strongly agree  ndikugwirizana nazo kwam"="strongly agree", 
      "agree  ndikugwirizana nazo"="agree", 
      "neutral  osakhala mbali iliyonse"= "neutral", 
       "strongly disagree  sindikugwirizana nazo"="strongly disagree"),
      
      
      digital_detect=recode(
      digital_detect,
       "strongly agree  ndikugwirizana nazo kwam"="strongly agree", 
      "agree  ndikugwirizana nazo"="agree"),
      
      accept_digitaltool=recode(
      accept_digitaltool,
      "strongly agree  ndikugwirizana nazo kwam"="strongly agree", 
      "agree  ndikugwirizana nazo"="agree", 
      "neutral  osakhala mbali iliyonse"= "neutral", 
      "strongly disagree  sindikugwirizana nazo"="strongly disagree"
        ), 
     rece_repo_alert=recode(
       rece_repo_alert, 
       "in person"="in-person"
     )) %>%
  mutate(
    age_group = case_when(
       age >= 18 & age <= 24 ~ "18-24",
       age >= 25 & age <= 29 ~ "25-29",
       age >= 30 & age <= 34 ~ "30-34",
       age >= 35 & age <= 39 ~ "35-39",
       age >= 40 & age <= 44 ~ "40-44",
       age >= 45 & age <= 49 ~ "45-49",
       age >= 50 & age <= 54 ~ "50-54",
       age >= 55 & age <= 59 ~ "55-59",
       age >= 60 & age <= 64 ~ "60-64",
       age >= 65 & age <= 69 ~ "65-69",
       age >= 70 & age <= 74 ~ "70-74",
       age >= 75 & age <= 79 ~ "75-79",
       age >= 80 & age <= 84 ~ "80-84",
       age >= 85             ~ "85+",
       TRUE                  ~ "Unknown"
    ))
  
demo_v<-c("gender", "age_group", "edu", "locat", "district")




```

## Table 1: Demographic characteristics of study participants (N=200)

```{r}
#| echo: false

ppt_data |> 
  select(gender, age, edu, locat, district, electronic_have, internet_have) |>
  mutate(electronic_have = as.factor(electronic_have)) |> 
  tbl_summary(
    
      label = list(
      gender ~ "Gender", 
      age ~ "Age (years)",
      edu ~ "Education level",
      locat ~ "Location",
      district ~ "District", 
      electronic_have~ " Owenship of phone", 
      internet_have~ " Owenship of smart phone"
    ),
    type = list( all_dichotomous()~ "categorical"),
    statistic = list(
      all_dichotomous()~ "categorical",
      all_continuous() ~ "{mean} ({sd})",
      all_categorical() ~ "{n} ({p}%)"
    ),
    digits = all_continuous() ~ 2
  )


```

# Descriptive Analysis on Awareness of Digital Health Surveillance

## Table 2:

```{r}
#| echo: false

table2 <- ppt_data |> 
select(know_digital_health_surve, 
       report_ill, 
       familiar_digitalhealth,# change the value of " heard of nut never used" to "not familiar"
       receive_phinformation_phone, 
       digital_report)
 

table2 %>% 
  tbl_summary(
    
    label = list(
     know_digital_health_surve ~"Aware of Digital Health Surveillance", 
     report_ill~"Reported illness before using electronic gauges", 
     familiar_digitalhealth ~ "Familiar with Digital health Tools",
     receive_phinformation_phone~ "Received health information via Phone", 
     digital_report~ "Seen or Heard Campaigns promoting Digital Reporting"),
    
    type = list( all_dichotomous()~ "categorical"),
    statistic = list(
      all_dichotomous()~ "categorical",
      all_continuous() ~ "{mean} ({sd})",
      all_categorical() ~ "{n} ({p}%)"
    ),
    digits = all_continuous() ~ 2
    
  )

# preparing data set for plot1 

graph1 <- ppt_data %>% 
  select(
    where_healthsur_healthworker, 
    where_healthsur_tv, 
    where_healthsur_community, 
    where_healthsur_socialmedia, 
    where_healthsur_sms, 
    where_healthsur_faf
  ) %>% 
  rename(
   healthworker= where_healthsur_healthworker, 
   tv_radio=where_healthsur_tv, 
   community_meeting=where_healthsur_community, 
    social_media= where_healthsur_socialmedia, 
   sms_from_moh=where_healthsur_sms, 
    friends_family= where_healthsur_faf
  ) %>% 
  pivot_longer(
    cols = c(1:6), 
    names_to = "Variable", 
    values_to = "Frequncy"
  ) %>% 
  filter(Frequncy==1) %>% 
  group_by(Variable) %>% 
  summarise(Frequncy= sum(Frequncy)) %>% 
  mutate(precent= round(Frequncy/sum(Frequncy), 3)*100)

# plotting the chart 1
graph1<- graph1 %>% 
 ggplot(aes(x = reorder(Variable, precent), y = precent)) +
  geom_col(fill = "steelblue") +
  geom_label(aes(label = precent), vjust = 1.5, size = 4) +
  labs(
    title = "Awareness Sources of Digital Health Surveillance",
    x = "Sources",
    y = "Percentage"
  ) +
  theme_classic() +
  theme(
    legend.position = "none",   # remove legends if any
    plot.title = element_text(hjust = 0.5, face = "bold") # center & bold title
  )+
  coord_flip()

# preparing data set for plot 2 

graph2 <- ppt_data %>% 
  select(
    receive_via_healthworker, 
    receive_via_tv, 
    receive_via_community, 
    receive_via_socialmedia, 
    receive_via_sms, 
    receive_via_faf
  ) %>% 
  rename(
   healthworker=receive_via_healthworker, 
   tv_radio=receive_via_tv, 
    community_meeting=receive_via_community, 
    social_media=receive_via_socialmedia, 
    sms_from_moh=receive_via_sms, 
    freend_family=receive_via_faf
  ) %>% 
  pivot_longer(
    cols = c(1:6), 
    names_to = "Variable", 
    values_to = "Frequncy"
  ) %>% 
  filter(Frequncy==1) %>% 
  group_by(Variable) %>% 
  summarise(Frequncy= sum(Frequncy)) %>% 
  mutate(precent= round(Frequncy/sum(Frequncy), 3)*100)

# plotting the chart 2
graph2<- graph2 %>% 
  ggplot(aes(x = reorder(Variable, precent), y = precent)) +
  geom_col(fill = "steelblue") +
  geom_label(aes(label = precent), vjust = 1.5, size = 4) +
  labs(
    title = "Channel of recieve health information",
    x = "Sources",
    y = "Percentage"
  ) +
  theme_classic() +
  theme(
    legend.position = "none",   # remove legends if any
    plot.title = element_text(hjust = 0.5, face = "bold") # center & bold title
  )+
  coord_flip()


plot1<- plot_grid(graph1, graph2, labels = "AUTO")

ggsave(
  filename = here("output", "image", "plot1.png"),
  plot = plot1,
  dpi = 650,
  width = 12,
  height = 6,
  units = "in"
)






```


### Source and channels used for awareness and receive of digital health information
![](images/plot1.png)


# Descriptve analysis of attitudes towards digital health surveillance 

## Table 3:

```{r}
#| echo: false

table3<- ppt_data %>% 
  select(
    believe_report_ill, 
    comfort_report,
    use_digitalsystem, 
    digital_safe, 
    join_program, 
    digital_detect, 
    accept_digitaltool) %>% 
  rename(
    
  "Believe  using phone to report illness can improve health in community"=believe_report_ill, 
   "Feel comfortable reporting health sysmptoms through SMS or Mobile apps like Chatbots"= comfort_report,
  "Accept using digital system if it was approval by MoH"=use_digitalsystem, 
   "Believe person health data will be safe when submitted through digital tools"= digital_safe, 
    "Willing to participant in digital disease surveillance programs"=join_program, 
    "Trust digital systems can detect disease outbreaks early"=digital_detect, 
    "People can accept digital surveillance tools once properly explained"=accept_digitaltool  
  )


table3 %>% 
  pivot_longer(
    cols = c(1:7), 
    names_to = "Statement", 
    values_to = "Level_of_agreement"
  ) %>% 
  group_by(
    Statement, 
    Level_of_agreement
  ) %>% 
  tbl_summary(
    by= Level_of_agreement, 
    percent = "row",
     )


```


# Descriptive analysis on public practice in  use of digital health surveillance tool. 
## Table 4:

```{r}
#| echo: false
table4 <- ppt_data %>% 
  select(
    rece_repo_healthinfo, 
    rece_repo_alert,
    digital_workwell, 
    reported_12month, 
    frequency_to_access
    
  )


table4 %>% 
  tbl_summary(
    
      label = list(
     rece_repo_healthinfo ~"Use a Mobile phone or App to receive or report health information", 
     rece_repo_alert~"Prefered methods for reporting symptoms or receiving alerts", 
     digital_workwell ~ "Community thinks digital health surveillance works well",
     reported_12month~ "In last 12 Month, reported health related information using phone or digital tool", 
     frequency_to_access~ "Frequncy of using phone to access health service or information"),
    
    type = list( all_dichotomous()~ "categorical"),
    statistic = list(
      all_dichotomous()~ "categorical",
    all_categorical() ~ "{n} ({p}%)"
    ),
    digits = all_continuous() ~ 2
    
  )


```

# Motivation factors to participation in digital health surveillance  

```{r}
#| echo: false


plot2 <- ppt_data %>% 
  select(
    motivate_healthsur_result, 
    motivate_healthsur_advice, 
    motivate_healthsur_easysystem, 
    motivate_healthsur_helpcom, 
    motivate_healthsur_trustmoh, 
    motivate_healthsur_incentive, 
    ) %>% 
  rename(
    knowning_results=motivate_healthsur_result, 
    Receiving_adcice=motivate_healthsur_advice, 
    Easy_to_use_system=motivate_healthsur_easysystem, 
    Helping_Community=motivate_healthsur_helpcom, 
    Trust_in_MoH=motivate_healthsur_trustmoh, 
    Incentive=motivate_healthsur_incentive, 
    
    
  )



p2<- plot2  %>% 
  pivot_longer(
    cols = c(1:6), 
    names_to = "Motives",
    values_to = "Freq"
    ) %>% 
  filter(Freq==1) %>% 
  group_by(Motives) %>% 
  summarise(Freq=sum(Freq)) %>% 
  mutate(Motives=gsub("_", " ", Motives)) %>% 
  ggplot(
    aes(  reorder(x=Motives, Freq), y=Freq)
  )+
  geom_col(fill="steelblue")+
  theme_minimal()+
  coord_flip()+
  labs(
    title = "Motivation factors to participation in digital health surveillance ",
    x= " Factors", 
    y= "Frequency"
  )+
  geom_label(aes(label = Freq, hjust = 1))




```


# hindrance factors to participation in digital health surveillance 


```{r}
#| echo: false

# preparing data set
plot3 <- ppt_data %>% 
  select(
    stop_healthsur_poornet, 
    stop_healthsur_nonelec, 
    stop_healthsur_privacy, 
    stop_healthsur_nofeedback
  ) %>% 
  rename(
    
   poor_network=stop_healthsur_poornet, 
    No_confidence_with_electronic_gauges=stop_healthsur_nonelec, 
    Privacy_concerns=stop_healthsur_privacy, 
    No_feedback=stop_healthsur_nofeedback
  
  )

p3<- plot3 %>% 
  pivot_longer(
    cols = c(1:4), 
    names_to = "Hindrance_factors", 
    values_to = "Freq"
  ) %>% 
  filter(Freq==1) %>% 
  mutate(Hindrance_factors=gsub("_", " ",Hindrance_factors)) %>% 
  group_by(Hindrance_factors) %>% 
  summarise(Freq=sum(Freq)) %>% 
  ggplot(
    aes(  reorder(x=Hindrance_factors, Freq), y=Freq)
  )+
  geom_col(fill="steelblue")+
  theme_minimal()+
  coord_flip()+
  labs(
    title = "Hindrance factors to participation in digital health surveillance ",
    x= " Hindrance Factors", 
    y= "Frequency"
  )+
  geom_label(aes(label = Freq, hjust = 1))




plot2<- plot_grid(p2, p3, labels = "AUTO")



ggsave(
  filename = here("output", "image", "plot2.png"),
  plot = plot2,
  dpi = 650,
  width = 12,
  height = 6,
  bg="white",
  units = "in"
)


```

![](images/plot2.png)


## Table 5:

```{r}
#| echo: false


table5 <-ppt_data%>% 
  select(demo_v, electronic_have)



table5 %>% 
  tbl_summary(
    by=electronic_have, 
    percent = "row"
  ) %>% 
  add_ci() %>% 
  add_p()


  


```

